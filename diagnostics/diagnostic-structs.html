<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Diagnostic and subdiagnostic structs - Guide to Rustc Development</title>


        <!-- Custom HTML head -->
        
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="A guide to developing rustc">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->

    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item affix "><a href="../about-this-guide.html">About this guide</a></li><li class="chapter-item affix "><a href="../getting-started.html">Getting Started</a></li><li class="spacer"></li><li class="chapter-item affix "><li class="part-title">Building and debugging rustc</li><li class="chapter-item "><a href="../building/how-to-build-and-run.html"><strong aria-hidden="true">1.</strong> How to Build and Run the Compiler</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../building/prerequisites.html"><strong aria-hidden="true">1.1.</strong> Prerequisites</a></li><li class="chapter-item "><a href="../building/suggested.html"><strong aria-hidden="true">1.2.</strong> Suggested Workflows</a></li><li class="chapter-item "><a href="../building/build-install-distribution-artifacts.html"><strong aria-hidden="true">1.3.</strong> Distribution artifacts</a></li><li class="chapter-item "><a href="../building/compiler-documenting.html"><strong aria-hidden="true">1.4.</strong> Building Documentation</a></li><li class="chapter-item "><a href="../rustdoc.html"><strong aria-hidden="true">1.5.</strong> Rustdoc overview</a></li><li class="chapter-item "><a href="../building/new-target.html"><strong aria-hidden="true">1.6.</strong> Adding a new target</a></li></ol></li><li class="chapter-item "><a href="../tests/intro.html"><strong aria-hidden="true">2.</strong> Testing the compiler</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../tests/running.html"><strong aria-hidden="true">2.1.</strong> Running tests</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../tests/docker.html"><strong aria-hidden="true">2.1.1.</strong> Testing with Docker</a></li><li class="chapter-item "><a href="../tests/ci.html"><strong aria-hidden="true">2.1.2.</strong> Testing with CI</a></li></ol></li><li class="chapter-item "><a href="../tests/adding.html"><strong aria-hidden="true">2.2.</strong> Adding new tests</a></li><li class="chapter-item "><a href="../tests/compiletest.html"><strong aria-hidden="true">2.3.</strong> Compiletest</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../tests/ui.html"><strong aria-hidden="true">2.3.1.</strong> UI tests</a></li><li class="chapter-item "><a href="../tests/headers.html"><strong aria-hidden="true">2.3.2.</strong> Test headers</a></li></ol></li><li class="chapter-item "><a href="../tests/perf.html"><strong aria-hidden="true">2.4.</strong> Performance testing</a></li><li class="chapter-item "><a href="../tests/crater.html"><strong aria-hidden="true">2.5.</strong> Crater</a></li></ol></li><li class="chapter-item "><a href="../compiler-debugging.html"><strong aria-hidden="true">3.</strong> Debugging the Compiler</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../tracing.html"><strong aria-hidden="true">3.1.</strong> Using the tracing/logging instrumentation</a></li></ol></li><li class="chapter-item "><a href="../profiling.html"><strong aria-hidden="true">4.</strong> Profiling the compiler</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../profiling/with_perf.html"><strong aria-hidden="true">4.1.</strong> with the linux perf tool</a></li><li class="chapter-item "><a href="../profiling/wpa_profiling.html"><strong aria-hidden="true">4.2.</strong> with Windows Performance Analyzer</a></li></ol></li><li class="chapter-item "><a href="../crates-io.html"><strong aria-hidden="true">5.</strong> crates.io Dependencies</a></li><li class="chapter-item affix "><li class="part-title">Contributing to Rust</li><li class="chapter-item "><a href="../contributing.html"><strong aria-hidden="true">6.</strong> Introduction</a></li><li class="chapter-item "><a href="../compiler-team.html"><strong aria-hidden="true">7.</strong> About the compiler team</a></li><li class="chapter-item "><a href="../git.html"><strong aria-hidden="true">8.</strong> Using Git</a></li><li class="chapter-item "><a href="../rustbot.html"><strong aria-hidden="true">9.</strong> Mastering @rustbot</a></li><li class="chapter-item "><a href="../walkthrough.html"><strong aria-hidden="true">10.</strong> Walkthrough: a typical contribution</a></li><li class="chapter-item "><a href="../bug-fix-procedure.html"><strong aria-hidden="true">11.</strong> Bug Fix Procedure</a></li><li class="chapter-item "><a href="../implementing_new_features.html"><strong aria-hidden="true">12.</strong> Implementing new features</a></li><li class="chapter-item "><a href="../stability.html"><strong aria-hidden="true">13.</strong> Stability attributes</a></li><li class="chapter-item "><a href="../stabilization_guide.html"><strong aria-hidden="true">14.</strong> Stabilizing Features</a></li><li class="chapter-item "><a href="../feature-gates.html"><strong aria-hidden="true">15.</strong> Feature Gates</a></li><li class="chapter-item "><a href="../conventions.html"><strong aria-hidden="true">16.</strong> Coding conventions</a></li><li class="chapter-item "><a href="../notification-groups/about.html"><strong aria-hidden="true">17.</strong> Notification groups</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../notification-groups/arm.html"><strong aria-hidden="true">17.1.</strong> ARM</a></li><li class="chapter-item "><a href="../notification-groups/cleanup-crew.html"><strong aria-hidden="true">17.2.</strong> Cleanup Crew</a></li><li class="chapter-item "><a href="../notification-groups/llvm.html"><strong aria-hidden="true">17.3.</strong> LLVM</a></li><li class="chapter-item "><a href="../notification-groups/risc-v.html"><strong aria-hidden="true">17.4.</strong> RISC-V</a></li><li class="chapter-item "><a href="../notification-groups/windows.html"><strong aria-hidden="true">17.5.</strong> Windows</a></li></ol></li><li class="chapter-item "><a href="../licenses.html"><strong aria-hidden="true">18.</strong> Licenses</a></li><li class="chapter-item affix "><li class="part-title">High-level Compiler Architecture</li><li class="chapter-item "><a href="../part-2-intro.html"><strong aria-hidden="true">19.</strong> Prologue</a></li><li class="chapter-item "><a href="../overview.html"><strong aria-hidden="true">20.</strong> Overview of the Compiler</a></li><li class="chapter-item "><a href="../compiler-src.html"><strong aria-hidden="true">21.</strong> The compiler source code</a></li><li class="chapter-item "><a href="../building/bootstrapping.html"><strong aria-hidden="true">22.</strong> Bootstrapping</a></li><li class="chapter-item "><a href="../query.html"><strong aria-hidden="true">23.</strong> Queries: demand-driven compilation</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../queries/query-evaluation-model-in-detail.html"><strong aria-hidden="true">23.1.</strong> The Query Evaluation Model in Detail</a></li><li class="chapter-item "><a href="../queries/incremental-compilation.html"><strong aria-hidden="true">23.2.</strong> Incremental compilation</a></li><li class="chapter-item "><a href="../queries/incremental-compilation-in-detail.html"><strong aria-hidden="true">23.3.</strong> Incremental compilation In Detail</a></li><li class="chapter-item "><a href="../incrcomp-debugging.html"><strong aria-hidden="true">23.4.</strong> Debugging and Testing</a></li><li class="chapter-item "><a href="../salsa.html"><strong aria-hidden="true">23.5.</strong> Salsa</a></li></ol></li><li class="chapter-item "><a href="../memory.html"><strong aria-hidden="true">24.</strong> Memory Management in Rustc</a></li><li class="chapter-item "><a href="../serialization.html"><strong aria-hidden="true">25.</strong> Serialization in Rustc</a></li><li class="chapter-item "><a href="../parallel-rustc.html"><strong aria-hidden="true">26.</strong> Parallel Compilation</a></li><li class="chapter-item "><a href="../rustdoc-internals.html"><strong aria-hidden="true">27.</strong> Rustdoc internals</a></li><li class="chapter-item affix "><li class="part-title">Source Code Representation</li><li class="chapter-item "><a href="../part-3-intro.html"><strong aria-hidden="true">28.</strong> Prologue</a></li><li class="chapter-item "><a href="../cli.html"><strong aria-hidden="true">29.</strong> Command-line arguments</a></li><li class="chapter-item "><a href="../rustc-driver.html"><strong aria-hidden="true">30.</strong> The Rustc Driver and Interface</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../rustc-driver-interacting-with-the-ast.html"><strong aria-hidden="true">30.1.</strong> Example: Type checking</a></li><li class="chapter-item "><a href="../rustc-driver-getting-diagnostics.html"><strong aria-hidden="true">30.2.</strong> Example: Getting diagnostics</a></li></ol></li><li class="chapter-item "><a href="../syntax-intro.html"><strong aria-hidden="true">31.</strong> Syntax and the AST</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../the-parser.html"><strong aria-hidden="true">31.1.</strong> Lexing and Parsing</a></li><li class="chapter-item "><a href="../macro-expansion.html"><strong aria-hidden="true">31.2.</strong> Macro expansion</a></li><li class="chapter-item "><a href="../name-resolution.html"><strong aria-hidden="true">31.3.</strong> Name resolution</a></li><li class="chapter-item "><a href="../test-implementation.html"><strong aria-hidden="true">31.4.</strong> #[test] Implementation</a></li><li class="chapter-item "><a href="../panic-implementation.html"><strong aria-hidden="true">31.5.</strong> Panic Implementation</a></li><li class="chapter-item "><a href="../ast-validation.html"><strong aria-hidden="true">31.6.</strong> AST Validation</a></li><li class="chapter-item "><a href="../feature-gate-ck.html"><strong aria-hidden="true">31.7.</strong> Feature Gate Checking</a></li><li class="chapter-item "><a href="../lang-items.html"><strong aria-hidden="true">31.8.</strong> Lang Items</a></li></ol></li><li class="chapter-item "><a href="../hir.html"><strong aria-hidden="true">32.</strong> The HIR (High-level IR)</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../lowering.html"><strong aria-hidden="true">32.1.</strong> Lowering AST to HIR</a></li><li class="chapter-item "><a href="../hir-debugging.html"><strong aria-hidden="true">32.2.</strong> Debugging</a></li></ol></li><li class="chapter-item "><a href="../thir.html"><strong aria-hidden="true">33.</strong> The THIR (Typed High-level IR)</a></li><li class="chapter-item "><a href="../mir/index.html"><strong aria-hidden="true">34.</strong> The MIR (Mid-level IR)</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../mir/construction.html"><strong aria-hidden="true">34.1.</strong> MIR construction</a></li><li class="chapter-item "><a href="../mir/visitor.html"><strong aria-hidden="true">34.2.</strong> MIR visitor and traversal</a></li><li class="chapter-item "><a href="../mir/passes.html"><strong aria-hidden="true">34.3.</strong> MIR passes: getting the MIR for a function</a></li></ol></li><li class="chapter-item "><a href="../identifiers.html"><strong aria-hidden="true">35.</strong> Identifiers in the Compiler</a></li><li class="chapter-item "><a href="../closure.html"><strong aria-hidden="true">36.</strong> Closure expansion</a></li><li class="chapter-item "><a href="../asm.html"><strong aria-hidden="true">37.</strong> Inline assembly</a></li><li class="chapter-item affix "><li class="part-title">Analysis</li><li class="chapter-item "><a href="../part-4-intro.html"><strong aria-hidden="true">38.</strong> Prologue</a></li><li class="chapter-item "><a href="../ty.html"><strong aria-hidden="true">39.</strong> The ty module: representing types</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../generics.html"><strong aria-hidden="true">39.1.</strong> Generics and substitutions</a></li><li class="chapter-item "><a href="../ty-fold.html"><strong aria-hidden="true">39.2.</strong> TypeFolder and TypeFoldable</a></li><li class="chapter-item "><a href="../generic_arguments.html"><strong aria-hidden="true">39.3.</strong> Generic arguments</a></li><li class="chapter-item "><a href="../constants.html"><strong aria-hidden="true">39.4.</strong> Constants in the type system</a></li></ol></li><li class="chapter-item "><a href="../type-inference.html"><strong aria-hidden="true">40.</strong> Type inference</a></li><li class="chapter-item "><a href="../traits/resolution.html"><strong aria-hidden="true">41.</strong> Trait solving</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../early-late-bound.html"><strong aria-hidden="true">41.1.</strong> Early and Late Bound Parameters</a></li><li class="chapter-item "><a href="../traits/hrtb.html"><strong aria-hidden="true">41.2.</strong> Higher-ranked trait bounds</a></li><li class="chapter-item "><a href="../traits/caching.html"><strong aria-hidden="true">41.3.</strong> Caching subtleties</a></li><li class="chapter-item "><a href="../traits/specialization.html"><strong aria-hidden="true">41.4.</strong> Specialization</a></li><li class="chapter-item "><a href="../traits/chalk.html"><strong aria-hidden="true">41.5.</strong> Chalk-based trait solving</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../traits/lowering-to-logic.html"><strong aria-hidden="true">41.5.1.</strong> Lowering to logic</a></li><li class="chapter-item "><a href="../traits/goals-and-clauses.html"><strong aria-hidden="true">41.5.2.</strong> Goals and clauses</a></li><li class="chapter-item "><a href="../traits/canonical-queries.html"><strong aria-hidden="true">41.5.3.</strong> Canonical queries</a></li></ol></li><li class="chapter-item "><a href="../solve/trait-solving.html"><strong aria-hidden="true">41.6.</strong> Next-gen trait solving</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../solve/the-solver.html"><strong aria-hidden="true">41.6.1.</strong> The solver</a></li><li class="chapter-item "><a href="../solve/canonicalization.html"><strong aria-hidden="true">41.6.2.</strong> Canonicalization</a></li><li class="chapter-item "><a href="../solve/coinduction.html"><strong aria-hidden="true">41.6.3.</strong> Coinduction</a></li></ol></li></ol></li><li class="chapter-item "><a href="../type-checking.html"><strong aria-hidden="true">42.</strong> Type checking</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../method-lookup.html"><strong aria-hidden="true">42.1.</strong> Method Lookup</a></li><li class="chapter-item "><a href="../variance.html"><strong aria-hidden="true">42.2.</strong> Variance</a></li><li class="chapter-item "><a href="../opaque-types-type-alias-impl-trait.html"><strong aria-hidden="true">42.3.</strong> Opaque Types</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../opaque-types-impl-trait-inference.html"><strong aria-hidden="true">42.3.1.</strong> Inference details</a></li></ol></li></ol></li><li class="chapter-item "><a href="../pat-exhaustive-checking.html"><strong aria-hidden="true">43.</strong> Pattern and Exhaustiveness Checking</a></li><li class="chapter-item "><a href="../mir/dataflow.html"><strong aria-hidden="true">44.</strong> MIR dataflow</a></li><li class="chapter-item "><a href="../mir/drop-elaboration.html"><strong aria-hidden="true">45.</strong> Drop elaboration</a></li><li class="chapter-item "><a href="../borrow_check.html"><strong aria-hidden="true">46.</strong> The borrow checker</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../borrow_check/moves_and_initialization.html"><strong aria-hidden="true">46.1.</strong> Tracking moves and initialization</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../borrow_check/moves_and_initialization/move_paths.html"><strong aria-hidden="true">46.1.1.</strong> Move paths</a></li></ol></li><li class="chapter-item "><a href="../borrow_check/type_check.html"><strong aria-hidden="true">46.2.</strong> MIR type checker</a></li><li class="chapter-item "><a href="../borrow_check/region_inference.html"><strong aria-hidden="true">46.3.</strong> Region inference</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../borrow_check/region_inference/constraint_propagation.html"><strong aria-hidden="true">46.3.1.</strong> Constraint propagation</a></li><li class="chapter-item "><a href="../borrow_check/region_inference/lifetime_parameters.html"><strong aria-hidden="true">46.3.2.</strong> Lifetime parameters</a></li><li class="chapter-item "><a href="../borrow_check/region_inference/member_constraints.html"><strong aria-hidden="true">46.3.3.</strong> Member constraints</a></li><li class="chapter-item "><a href="../borrow_check/region_inference/placeholders_and_universes.html"><strong aria-hidden="true">46.3.4.</strong> Placeholders and universes</a></li><li class="chapter-item "><a href="../borrow_check/region_inference/closure_constraints.html"><strong aria-hidden="true">46.3.5.</strong> Closure constraints</a></li><li class="chapter-item "><a href="../borrow_check/region_inference/error_reporting.html"><strong aria-hidden="true">46.3.6.</strong> Error reporting</a></li></ol></li><li class="chapter-item "><a href="../borrow_check/two_phase_borrows.html"><strong aria-hidden="true">46.4.</strong> Two-phase-borrows</a></li></ol></li><li class="chapter-item "><a href="../param_env.html"><strong aria-hidden="true">47.</strong> Parameter Environments</a></li><li class="chapter-item expanded "><a href="../diagnostics.html"><strong aria-hidden="true">48.</strong> Errors and Lints</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../diagnostics/diagnostic-structs.html" class="active"><strong aria-hidden="true">48.1.</strong> Diagnostic and subdiagnostic structs</a></li><li class="chapter-item "><a href="../diagnostics/translation.html"><strong aria-hidden="true">48.2.</strong> Translation</a></li><li class="chapter-item "><a href="../diagnostics/lintstore.html"><strong aria-hidden="true">48.3.</strong> LintStore</a></li><li class="chapter-item "><a href="../diagnostics/diagnostic-codes.html"><strong aria-hidden="true">48.4.</strong> Diagnostic codes</a></li><li class="chapter-item "><a href="../diagnostics/diagnostic-items.html"><strong aria-hidden="true">48.5.</strong> Diagnostic items</a></li><li class="chapter-item "><a href="../diagnostics/error-guaranteed.html"><strong aria-hidden="true">48.6.</strong> ErrorGuaranteed</a></li></ol></li><li class="chapter-item "><li class="part-title">MIR to Binaries</li><li class="chapter-item "><a href="../part-5-intro.html"><strong aria-hidden="true">49.</strong> Prologue</a></li><li class="chapter-item "><a href="../mir/optimizations.html"><strong aria-hidden="true">50.</strong> MIR optimizations</a></li><li class="chapter-item "><a href="../mir/debugging.html"><strong aria-hidden="true">51.</strong> Debugging</a></li><li class="chapter-item "><a href="../const-eval.html"><strong aria-hidden="true">52.</strong> Constant evaluation</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../const-eval/interpret.html"><strong aria-hidden="true">52.1.</strong> Interpreter</a></li></ol></li><li class="chapter-item "><a href="../backend/monomorph.html"><strong aria-hidden="true">53.</strong> Monomorphization</a></li><li class="chapter-item "><a href="../backend/lowering-mir.html"><strong aria-hidden="true">54.</strong> Lowering MIR</a></li><li class="chapter-item "><a href="../backend/codegen.html"><strong aria-hidden="true">55.</strong> Code Generation</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../backend/updating-llvm.html"><strong aria-hidden="true">55.1.</strong> Updating LLVM</a></li><li class="chapter-item "><a href="../backend/debugging.html"><strong aria-hidden="true">55.2.</strong> Debugging LLVM</a></li><li class="chapter-item "><a href="../backend/backend-agnostic.html"><strong aria-hidden="true">55.3.</strong> Backend Agnostic Codegen</a></li><li class="chapter-item "><a href="../backend/implicit-caller-location.html"><strong aria-hidden="true">55.4.</strong> Implicit Caller Location</a></li></ol></li><li class="chapter-item "><a href="../backend/libs-and-metadata.html"><strong aria-hidden="true">56.</strong> Libraries and Metadata</a></li><li class="chapter-item "><a href="../profile-guided-optimization.html"><strong aria-hidden="true">57.</strong> Profile-guided Optimization</a></li><li class="chapter-item "><a href="../llvm-coverage-instrumentation.html"><strong aria-hidden="true">58.</strong> LLVM Source-Based Code Coverage</a></li><li class="chapter-item "><a href="../sanitizers.html"><strong aria-hidden="true">59.</strong> Sanitizers Support</a></li><li class="chapter-item "><a href="../debugging-support-in-rustc.html"><strong aria-hidden="true">60.</strong> Debugging Support in the Rust Compiler</a></li><li class="spacer"></li><li class="chapter-item affix "><a href="../appendix/background.html">Appendix A: Background topics</a></li><li class="chapter-item affix "><a href="../appendix/glossary.html">Appendix B: Glossary</a></li><li class="chapter-item affix "><a href="../appendix/code-index.html">Appendix C: Code Index</a></li><li class="chapter-item affix "><a href="../appendix/compiler-lecture.html">Appendix D: Compiler Lecture Series</a></li><li class="chapter-item affix "><a href="../appendix/bibliography.html">Appendix E: Bibliography</a></li><li class="chapter-item affix "><a href="../appendix/humorust.html">Appendix Z: HumorRust</a></li><li class="spacer"></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Guide to Rustc Development</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/rust-lang/rustc-dev-guide" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>
                        <a href="https://github.com/rust-lang/rustc-dev-guide/edit/master/src/diagnostics/diagnostic-structs.md" title="Suggest an edit" aria-label="Suggest an edit">
                            <i id="git-edit-button" class="fa fa-edit"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="diagnostic-and-subdiagnostic-structs"><a class="header" href="#diagnostic-and-subdiagnostic-structs">Diagnostic and subdiagnostic structs</a></h1>
<p>rustc has two diagnostic derives that can be used to create simple diagnostics,
which are recommended to be used when they are applicable:
<code>#[derive(Diagnostic)]</code> and <code>#[derive(Subdiagnostic)]</code>.</p>
<p>Diagnostics created with the derive macros can be translated into different
languages and each has a slug that uniquely identifies the diagnostic.</p>
<h2 id="derivediagnostic"><a class="header" href="#derivediagnostic"><code>#[derive(Diagnostic)]</code></a></h2>
<p>Instead of using the <code>DiagnosticBuilder</code> API to create and emit diagnostics,
the <code>Diagnostic</code> derive can be used. <code>#[derive(Diagnostic)]</code> is
only applicable for simple diagnostics that don't require much logic in
deciding whether or not to add additional subdiagnostics.</p>
<p>Consider the <a href="https://github.com/rust-lang/rust/blob/6201eabde85db854c1ebb57624be5ec699246b50/compiler/rustc_hir_analysis/src/errors.rs#L68-L77">definition</a> of the &quot;field already declared&quot; diagnostic
shown below:</p>
<pre><code class="language-rust ignore">#[derive(Diagnostic)]
#[diag(hir_analysis_field_already_declared, code = &quot;E0124&quot;)]
pub struct FieldAlreadyDeclared {
    pub field_name: Ident,
    #[primary_span]
    #[label]
    pub span: Span,
    #[label(hir_analysis_previous_decl_label)]
    pub prev_span: Span,
}
</code></pre>
<p><code>Diagnostic</code> can only be applied to structs and enums. 
Attributes that are placed on the type for structs are placed on each 
variants for enums (or vice versa). Each <code>Diagnostic</code> has to have one
attribute, <code>#[diag(...)]</code>, applied to the struct or each enum variant.</p>
<p>If an error has an error code (e.g. &quot;E0624&quot;), then that can be specified using
the <code>code</code> sub-attribute. Specifying a <code>code</code> isn't mandatory, but if you are
porting a diagnostic that uses <code>DiagnosticBuilder</code> to use <code>Diagnostic</code>
then you should keep the code if there was one.</p>
<p><code>#[diag(..)]</code> must provide a slug as the first positional argument (a path to an
item in <code>rustc_errors::fluent::*</code>). A slug uniquely identifies the diagnostic
and is also how the compiler knows what error message to emit (in the default
locale of the compiler, or in the locale requested by the user). See
<a href="./translation.html">translation documentation</a> to learn more about how
translatable error messages are written and how slug items are generated.</p>
<p>In our example, the Fluent message for the &quot;field already declared&quot; diagnostic
looks like this:</p>
<pre><code class="language-fluent">hir_analysis_field_already_declared =
    field `{$field_name}` is already declared
    .label = field already declared
    .previous_decl_label = `{$field_name}` first declared here
</code></pre>
<p><code>hir_analysis_field_already_declared</code> is the slug from our example and is followed
by the diagnostic message.</p>
<p>Every field of the <code>Diagnostic</code> which does not have an annotation is
available in Fluent messages as a variable, like <code>field_name</code> in the example
above. Fields can be annotated <code>#[skip_arg]</code> if this is undesired.</p>
<p>Using the <code>#[primary_span]</code> attribute on a field (that has type <code>Span</code>)
indicates the primary span of the diagnostic which will have the main message
of the diagnostic.</p>
<p>Diagnostics are more than just their primary message, they often include
labels, notes, help messages and suggestions, all of which can also be
specified on a <code>Diagnostic</code>.</p>
<p><code>#[label]</code>, <code>#[help]</code> and <code>#[note]</code> can all be applied to fields which have the
type <code>Span</code>. Applying any of these attributes will create the corresponding
subdiagnostic with that <code>Span</code>. These attributes will look for their
diagnostic message in a Fluent attribute attached to the primary Fluent
message. In our example, <code>#[label]</code> will look for
<code>hir_analysis_field_already_declared.label</code> (which has the message &quot;field already
declared&quot;). If there is more than one subdiagnostic of the same type, then
these attributes can also take a value that is the attribute name to look for
(e.g. <code>previous_decl_label</code> in our example).</p>
<p>Other types have special behavior when used in a <code>Diagnostic</code> derive:</p>
<ul>
<li>Any attribute applied to an <code>Option&lt;T&gt;</code> and will only emit a
subdiagnostic if the option is <code>Some(..)</code>.</li>
<li>Any attribute applied to a <code>Vec&lt;T&gt;</code> will be repeated for each element of the
vector.</li>
</ul>
<p><code>#[help]</code> and <code>#[note]</code> can also be applied to the struct itself, in which case
they work exactly like when applied to fields except the subdiagnostic won't
have a <code>Span</code>. These attributes can also be applied to fields of type <code>()</code> for
the same effect, which when combined with the <code>Option</code> type can be used to
represent optional <code>#[note]</code>/<code>#[help]</code> subdiagnostics.</p>
<p>Suggestions can be emitted using one of four field attributes:</p>
<ul>
<li><code>#[suggestion(slug, code = &quot;...&quot;, applicability = &quot;...&quot;)]</code></li>
<li><code>#[suggestion_hidden(slug, code = &quot;...&quot;, applicability = &quot;...&quot;)]</code></li>
<li><code>#[suggestion_short(slug, code = &quot;...&quot;, applicability = &quot;...&quot;)]</code></li>
<li><code>#[suggestion_verbose(slug, code = &quot;...&quot;, applicability = &quot;...&quot;)]</code></li>
</ul>
<p>Suggestions must be applied on either a <code>Span</code> field or a <code>(Span, MachineApplicability)</code> field. Similarly to other field attributes, the slug
specifies the Fluent attribute with the message and defaults to the equivalent
of <code>.suggestion</code>. <code>code</code> specifies the code that should be suggested as a
replacement and is a format string (e.g. <code>{field_name}</code> would be replaced by
the value of the <code>field_name</code> field of the struct), not a Fluent identifier.
<code>applicability</code> can be used to specify the applicability in the attribute, it
cannot be used when the field's type contains an <code>Applicability</code>.</p>
<p>In the end, the <code>Diagnostic</code> derive will generate an implementation of
<code>IntoDiagnostic</code> that looks like the following:</p>
<pre><code class="language-rust ignore">impl IntoDiagnostic&lt;'_&gt; for FieldAlreadyDeclared {
    fn into_diagnostic(self, handler: &amp;'_ rustc_errors::Handler) -&gt; DiagnosticBuilder&lt;'_&gt; {
        let mut diag = handler.struct_err(rustc_errors::fluent::hir_analysis_field_already_declared);
        diag.set_span(self.span);
        diag.span_label(
            self.span,
            rustc_errors::fluent::hir_analysis_label
        );
        diag.span_label(
            self.prev_span,
            rustc_errors::fluent::hir_analysis_previous_decl_label
        );
        diag
    }
}
</code></pre>
<p>Now that we've defined our diagnostic, how do we <a href="https://github.com/rust-lang/rust/blob/f1112099eba41abadb6f921df7edba70affe92c5/compiler/rustc_hir_analysis/src/collect.rs#L823-L827">use it</a>? It's quite
straightforward, just create an instance of the struct and pass it to
<code>emit_err</code> (or <code>emit_warning</code>):</p>
<pre><code class="language-rust ignore">tcx.sess.emit_err(FieldAlreadyDeclared {
    field_name: f.ident,
    span: f.span,
    prev_span,
});
</code></pre>
<h3 id="reference"><a class="header" href="#reference">Reference</a></h3>
<p><code>#[derive(Diagnostic)]</code> and <code>#[derive(LintDiagnostic)]</code> support the
following attributes:</p>
<ul>
<li><code>#[diag(slug, code = &quot;...&quot;)]</code>
<ul>
<li><em>Applied to struct or enum variant.</em></li>
<li><em>Mandatory</em></li>
<li>Defines the text and error code to be associated with the diagnostic.</li>
<li>Slug (<em>Mandatory</em>)
<ul>
<li>Uniquely identifies the diagnostic and corresponds to its Fluent message,
mandatory.</li>
<li>A path to an item in <code>rustc_errors::fluent</code>, e.g.
<code>rustc_errors::fluent::hir_analysis_field_already_declared</code>
(<code>rustc_errors::fluent</code> is implicit in the attribute, so just
<code>hir_analysis_field_already_declared</code>).</li>
<li>See <a href="./translation.html">translation documentation</a>.</li>
</ul>
</li>
<li><code>code = &quot;...&quot;</code> (<em>Optional</em>)
<ul>
<li>Specifies the error code.</li>
</ul>
</li>
</ul>
</li>
<li><code>#[note]</code> or <code>#[note(slug)]</code> (<em>Optional</em>)
<ul>
<li><em>Applied to struct or <code>Span</code>/<code>()</code> fields.</em></li>
<li>Adds a note subdiagnostic.</li>
<li>Value is a path to an item in <code>rustc_errors::fluent</code> for the note's
message.
<ul>
<li>Defaults to equivalent of <code>.note</code>.</li>
</ul>
</li>
<li>If applied to a <code>Span</code> field, creates a spanned note.</li>
</ul>
</li>
<li><code>#[help]</code> or <code>#[help(slug)]</code> (<em>Optional</em>)
<ul>
<li><em>Applied to struct or <code>Span</code>/<code>()</code> fields.</em></li>
<li>Adds a help subdiagnostic.</li>
<li>Value is a path to an item in <code>rustc_errors::fluent</code> for the note's
message.
<ul>
<li>Defaults to equivalent of <code>.help</code>.</li>
</ul>
</li>
<li>If applied to a <code>Span</code> field, creates a spanned help.</li>
</ul>
</li>
<li><code>#[label]</code> or <code>#[label(slug)]</code> (<em>Optional</em>)
<ul>
<li><em>Applied to <code>Span</code> fields.</em></li>
<li>Adds a label subdiagnostic.</li>
<li>Value is a path to an item in <code>rustc_errors::fluent</code> for the note's
message.
<ul>
<li>Defaults to equivalent of <code>.label</code>.</li>
</ul>
</li>
</ul>
</li>
<li><code>#[warn_]</code> or <code>#[warn_(slug)]</code> (<em>Optional</em>)
<ul>
<li><em>Applied to <code>Span</code> fields.</em></li>
<li>Adds a warning subdiagnostic.</li>
<li>Value is a path to an item in <code>rustc_errors::fluent</code> for the note's
message.
<ul>
<li>Defaults to equivalent of <code>.warn</code>.</li>
</ul>
</li>
</ul>
</li>
<li><code>#[suggestion{,_hidden,_short,_verbose}(slug, code = &quot;...&quot;, applicability = &quot;...&quot;)]</code>
(<em>Optional</em>)
<ul>
<li><em>Applied to <code>(Span, MachineApplicability)</code> or <code>Span</code> fields.</em></li>
<li>Adds a suggestion subdiagnostic.</li>
<li>Slug (<em>Mandatory</em>)
<ul>
<li>A path to an item in <code>rustc_errors::fluent</code>, e.g.
<code>rustc_errors::fluent::hir_analysis_field_already_declared</code>
(<code>rustc_errors::fluent</code> is implicit in the attribute, so just
<code>hir_analysis_field_already_declared</code>). Fluent attributes for all messages
exist as top-level items in that module (so <code>hir_analysis_message.attr</code> is just
<code>attr</code>).</li>
<li>See <a href="./translation.html">translation documentation</a>.</li>
<li>Defaults to <code>rustc_errors::fluent::_subdiag::suggestion</code> (or</li>
<li><code>.suggestion</code> in Fluent).</li>
</ul>
</li>
<li><code>code = &quot;...&quot;</code>/<code>code(&quot;...&quot;, ...)</code> (<em>Mandatory</em>)
<ul>
<li>One or multiple format strings indicating the code to be suggested as a
replacement. Multiple values signify multiple possible replacements.</li>
</ul>
</li>
<li><code>applicability = &quot;...&quot;</code> (<em>Optional</em>)
<ul>
<li>String which must be one of <code>machine-applicable</code>, <code>maybe-incorrect</code>,
<code>has-placeholders</code> or <code>unspecified</code>.</li>
</ul>
</li>
</ul>
</li>
<li><code>#[subdiagnostic]</code>
<ul>
<li><em>Applied to a type that implements <code>AddToDiagnostic</code> (from
<code>#[derive(Subdiagnostic)]</code>).</em></li>
<li>Adds the subdiagnostic represented by the subdiagnostic struct.</li>
</ul>
</li>
<li><code>#[primary_span]</code> (<em>Optional</em>)
<ul>
<li><em>Applied to <code>Span</code> fields on <code>Subdiagnostic</code>s. Not used for <code>LintDiagnostic</code>s.</em></li>
<li>Indicates the primary span of the diagnostic.</li>
</ul>
</li>
<li><code>#[skip_arg]</code> (<em>Optional</em>)
<ul>
<li><em>Applied to any field.</em></li>
<li>Prevents the field from being provided as a diagnostic argument.</li>
</ul>
</li>
</ul>
<h2 id="derivesubdiagnostic"><a class="header" href="#derivesubdiagnostic"><code>#[derive(Subdiagnostic)]</code></a></h2>
<p>It is common in the compiler to write a function that conditionally adds a
specific subdiagnostic to an error if it is applicable. Oftentimes these
subdiagnostics could be represented using a diagnostic struct even if the
overall diagnostic could not. In this circumstance, the <code>Subdiagnostic</code>
derive can be used to represent a partial diagnostic (e.g a note, label, help or
suggestion) as a struct.</p>
<p>Consider the <a href="https://github.com/rust-lang/rust/blob/f1112099eba41abadb6f921df7edba70affe92c5/compiler/rustc_hir_analysis/src/errors.rs#L221-L234">definition</a> of the &quot;expected return type&quot; label
shown below:</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>#[derive(Subdiagnostic)]
pub enum ExpectedReturnTypeLabel&lt;'tcx&gt; {
    #[label(hir_analysis_expected_default_return_type)]
    Unit {
        #[primary_span]
        span: Span,
    },
    #[label(hir_analysis_expected_return_type)]
    Other {
        #[primary_span]
        span: Span,
        expected: Ty&lt;'tcx&gt;,
    },
}
<span class="boring">}
</span></code></pre></pre>
<p>Like <code>Diagnostic</code>, <code>Subdiagnostic</code> can be applied to structs or
enums. Attributes that are placed on the type for structs are placed on each
variants for enums (or vice versa). Each <code>Subdiagnostic</code> should have one
attribute applied to the struct or each variant, one of:</p>
<ul>
<li><code>#[label(..)]</code> for defining a label</li>
<li><code>#[note(..)]</code> for defining a note</li>
<li><code>#[help(..)]</code> for defining a help</li>
<li><code>#[suggestion{,_hidden,_short,_verbose}(..)]</code> for defining a suggestion</li>
</ul>
<p>All of the above must provide a slug as the first positional argument (a path
to an item in <code>rustc_errors::fluent::*</code>). A slug uniquely identifies the
diagnostic and is also how the compiler knows what error message to emit (in
the default locale of the compiler, or in the locale requested by the user).
See <a href="./translation.html">translation documentation</a> to learn more about how
translatable error messages are written and how slug items are generated.</p>
<p>In our example, the Fluent message for the &quot;expected return type&quot; label
looks like this:</p>
<pre><code class="language-fluent">hir_analysis_expected_default_return_type = expected `()` because of default return type

hir_analysis_expected_return_type = expected `{$expected}` because of return type
</code></pre>
<p>Using the <code>#[primary_span]</code> attribute on a field (with type <code>Span</code>) will denote
the primary span of the subdiagnostic. A primary span is only necessary for a
label or suggestion, which can not be spanless.</p>
<p>Every field of the type/variant which does not have an annotation is available
in Fluent messages as a variable. Fields can be annotated <code>#[skip_arg]</code> if this
is undesired.</p>
<p>Like <code>Diagnostic</code>, <code>Subdiagnostic</code> supports <code>Option&lt;T&gt;</code> and
<code>Vec&lt;T&gt;</code> fields.</p>
<p>Suggestions can be emitted using one of four attributes on the type/variant:</p>
<ul>
<li><code>#[suggestion(..., code = &quot;...&quot;, applicability = &quot;...&quot;)]</code></li>
<li><code>#[suggestion_hidden(..., code = &quot;...&quot;, applicability = &quot;...&quot;)]</code></li>
<li><code>#[suggestion_short(..., code = &quot;...&quot;, applicability = &quot;...&quot;)]</code></li>
<li><code>#[suggestion_verbose(..., code = &quot;...&quot;, applicability = &quot;...&quot;)]</code></li>
</ul>
<p>Suggestions require <code>#[primary_span]</code> be set on a field and can have the
following sub-attributes:</p>
<ul>
<li>The first positional argument specifies the path to a item in
<code>rustc_errors::fluent</code> corresponding to the Fluent attribute with the message
and defaults to the equivalent of <code>.suggestion</code>.</li>
<li><code>code</code> specifies the code that should be suggested as a replacement and is a
format string (e.g. <code>{field_name}</code> would be replaced by the value of the
<code>field_name</code> field of the struct), not a Fluent identifier.</li>
<li><code>applicability</code> can be used to specify the applicability in the attribute, it
cannot be used when the field's type contains an <code>Applicability</code>.</li>
</ul>
<p>Applicabilities can also be specified as a field (of type <code>Applicability</code>)
using the <code>#[applicability]</code> attribute.</p>
<p>In the end, the <code>Subdiagnostic</code> derive will generate an implementation
of <code>AddToDiagnostic</code> that looks like the following:</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>impl&lt;'tcx&gt; AddToDiagnostic for ExpectedReturnTypeLabel&lt;'tcx&gt; {
    fn add_to_diagnostic(self, diag: &amp;mut rustc_errors::Diagnostic) {
        use rustc_errors::{Applicability, IntoDiagnosticArg};
        match self {
            ExpectedReturnTypeLabel::Unit { span } =&gt; {
                diag.span_label(span, rustc_errors::fluent::hir_analysis_expected_default_return_type)
            }
            ExpectedReturnTypeLabel::Other { span, expected } =&gt; {
                diag.set_arg(&quot;expected&quot;, expected);
                diag.span_label(span, rustc_errors::fluent::hir_analysis_expected_return_type)
            }

        }
    }
}
<span class="boring">}
</span></code></pre></pre>
<p>Once defined, a subdiagnostic can be used by passing it to the <code>subdiagnostic</code>
function (<a href="https://github.com/rust-lang/rust/blob/f1112099eba41abadb6f921df7edba70affe92c5/compiler/rustc_hir_analysis/src/check/fn_ctxt/suggestions.rs#L670-L674">example</a> and <a href="https://github.com/rust-lang/rust/blob/f1112099eba41abadb6f921df7edba70affe92c5/compiler/rustc_hir_analysis/src/check/fn_ctxt/suggestions.rs#L704-L707">example</a>) on a
diagnostic or by assigning it to a <code>#[subdiagnostic]</code>-annotated field of a
diagnostic struct.</p>
<h3 id="reference-1"><a class="header" href="#reference-1">Reference</a></h3>
<p><code>#[derive(Subdiagnostic)]</code> supports the following attributes:</p>
<ul>
<li><code>#[label(slug)]</code>, <code>#[help(slug)]</code> or <code>#[note(slug)]</code>
<ul>
<li><em>Applied to struct or enum variant. Mutually exclusive with struct/enum variant attributes.</em></li>
<li><em>Mandatory</em></li>
<li>Defines the type to be representing a label, help or note.</li>
<li>Slug (<em>Mandatory</em>)
<ul>
<li>Uniquely identifies the diagnostic and corresponds to its Fluent message,
mandatory.</li>
<li>A path to an item in <code>rustc_errors::fluent</code>, e.g.
<code>rustc_errors::fluent::hir_analysis_field_already_declared</code>
(<code>rustc_errors::fluent</code> is implicit in the attribute, so just
<code>hir_analysis_field_already_declared</code>).</li>
<li>See <a href="./translation.html">translation documentation</a>.</li>
</ul>
</li>
</ul>
</li>
<li><code>#[suggestion{,_hidden,_short,_verbose}(slug, code = &quot;...&quot;, applicability = &quot;...&quot;)]</code>
<ul>
<li><em>Applied to struct or enum variant. Mutually exclusive with struct/enum variant attributes.</em></li>
<li><em>Mandatory</em></li>
<li>Defines the type to be representing a suggestion.</li>
<li>Slug (<em>Mandatory</em>)
<ul>
<li>A path to an item in <code>rustc_errors::fluent</code>, e.g.
<code>rustc_errors::fluent::hir_analysis_field_already_declared</code>
(<code>rustc_errors::fluent</code> is implicit in the attribute, so just
<code>hir_analysis::field_already_declared</code>). Fluent attributes for all messages
exist as top-level items in that module (so <code>hir_analysis_message.attr</code> is just
<code>hir_analysis::attr</code>).</li>
<li>See <a href="./translation.html">translation documentation</a>.</li>
<li>Defaults to <code>rustc_errors::fluent::_subdiag::suggestion</code> (or</li>
<li><code>.suggestion</code> in Fluent).</li>
</ul>
</li>
<li><code>code = &quot;...&quot;</code>/<code>code(&quot;...&quot;, ...)</code> (<em>Mandatory</em>)
<ul>
<li>One or multiple format strings indicating the code to be suggested as a
replacement. Multiple values signify multiple possible replacements.</li>
</ul>
</li>
<li><code>applicability = &quot;...&quot;</code> (<em>Optional</em>)
<ul>
<li><em>Mutually exclusive with <code>#[applicability]</code> on a field.</em></li>
<li>Value is the applicability of the suggestion.</li>
<li>String which must be one of:
<ul>
<li><code>machine-applicable</code></li>
<li><code>maybe-incorrect</code></li>
<li><code>has-placeholders</code></li>
<li><code>unspecified</code></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><code>#[multipart_suggestion{,_hidden,_short,_verbose}(slug, applicability = &quot;...&quot;)]</code>
<ul>
<li><em>Applied to struct or enum variant. Mutually exclusive with struct/enum variant attributes.</em></li>
<li><em>Mandatory</em></li>
<li>Defines the type to be representing a multipart suggestion.</li>
<li>Slug (<em>Mandatory</em>): see <code>#[suggestion]</code></li>
<li><code>applicability = &quot;...&quot;</code> (<em>Optional</em>): see <code>#[suggestion]</code></li>
</ul>
</li>
<li><code>#[primary_span]</code> (<em>Mandatory</em> for labels and suggestions; <em>optional</em> otherwise; not applicable
to multipart suggestions)
<ul>
<li><em>Applied to <code>Span</code> fields.</em></li>
<li>Indicates the primary span of the subdiagnostic.</li>
</ul>
</li>
<li><code>#[suggestion_part(code = &quot;...&quot;)]</code> (<em>Mandatory</em>; only applicable to multipart suggestions)
<ul>
<li><em>Applied to <code>Span</code> fields.</em></li>
<li>Indicates the span to be one part of the multipart suggestion.</li>
<li><code>code = &quot;...&quot;</code> (<em>Mandatory</em>)
<ul>
<li>Value is a format string indicating the code to be suggested as a
replacement.</li>
</ul>
</li>
</ul>
</li>
<li><code>#[applicability]</code> (<em>Optional</em>; only applicable to (simple and multipart) suggestions)
<ul>
<li><em>Applied to <code>Applicability</code> fields.</em></li>
<li>Indicates the applicability of the suggestion.</li>
</ul>
</li>
<li><code>#[skip_arg]</code> (<em>Optional</em>)
<ul>
<li><em>Applied to any field.</em></li>
<li>Prevents the field from being provided as a diagnostic argument.</li>
</ul>
</li>
</ul>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../diagnostics.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next" href="../diagnostics/translation.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../diagnostics.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next" href="../diagnostics/translation.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script type="text/javascript">
            window.playground_copyable = true;
        </script>


        <script src="../elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../searcher.js" type="text/javascript" charset="utf-8"></script>

        <script src="../clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="../book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        <script type="text/javascript" src="../mermaid.min.js"></script>
        <script type="text/javascript" src="../mermaid-init.js"></script>


    </body>
</html>
